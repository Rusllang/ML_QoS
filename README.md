# üß† –ú–æ–¥—É–ª—å: TrafficModelWrapper

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ú–æ–¥—É–ª—å `traffic_model.py` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—É—é –º–æ–¥–µ–ª—å –¥–ª—è **–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞** –∏ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª QoS –∏ ACL** –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ç–µ–≤—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏, –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.

---

## –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å: `TrafficModelWrapper`

### –ú–µ—Ç–æ–¥—ã:

#### `preprocess(df: pd.DataFrame, fit: bool = False) -> Tensor`
- –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∞—á–∏ –≤ –º–æ–¥–µ–ª—å.
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`protocol`) –≤ —á–∏—Å–ª–æ–≤—ã–µ.
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (`length`, `inter_arrival`, `ports` –∏ —Ç.–¥.)

#### `fit_model(X: Tensor, y: Tensor, epochs: int = 10, lr: float = 0.001)`
- –û–±—É—á–∞–µ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—É—é –º–æ–¥–µ–ª—å –Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö `X` –∏ –º–µ—Ç–∫–∞—Ö `y`.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä `Adam` –∏ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å `CrossEntropyLoss`.

#### `predict(X: Tensor) -> Tensor`
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Ç—Ä–∞—Ñ–∏–∫–∞.

#### `predict_and_generate_rules(df: pd.DataFrame) -> List[str]`
- –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–∏–ø —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ **—Å–µ—Ç–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, ACL –∏–ª–∏ QoS).
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ/—Ä–æ—É—Ç–µ—Ä–µ.

---

## –í—ã—Ö–æ–¥–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞, –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–æ–º:

| –ö–ª–∞—Å—Å           | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                       | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º–∞—è –∫–æ–º–∞–Ω–¥–∞ (–ø—Ä–∏–º–µ—Ä)                                         |
|----------------|-----------------------------------|------------------------------------------------------------------------|
| `normal`       | –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫                  | `# ALLOW traffic from 192.168.1.10`                                   |
| `syn_flood`    | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP                  | `iptables -A INPUT -s 10.0.0.1 -j DROP  # SYN Flood`                   |
| `udp_flood`    | –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ–ª–æ—Å—É (throttle)      | `tc qdisc add dev eth0 root netem rate 1mbit  # Throttle UDP`         |
| `icmp_flood`   | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å ICMP                | `iptables -A INPUT -p icmp -s 10.0.0.2 -j DROP  # ICMP Deprioritize`   |
| `ddos`         | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥—Å–µ—Ç—å             | `iptables -A INPUT -s 10.0.0.0/24 -j DROP  # DDoS Mitigation`          |

---

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
from traffic_model import TrafficModelWrapper
import pandas as pd
import torch

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_csv(\"parsed/traffic.csv\")
df['label'] = df['label'].map({'normal': 0, 'syn_flood': 1, 'udp_flood': 2, 'icmp_flood': 3, 'ddos': 4})

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ
model = TrafficModelWrapper()
X = model.preprocess(df, fit=True)
y = torch.tensor(df['label'].values, dtype=torch.long)
model.fit_model(X, y, epochs=10)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª
rules = model.predict_and_generate_rules(df)
for rule in rules[:5]:
    print(rule)
